!function(e,n){"function"==typeof define&&define.amd?define(n):e.k=e.KeyboardJS=n()}(this,function(){function e(n,e,t){n.addEventListener?n.addEventListener(e,t,!1):n.attachEvent("on"+e,function(e){return t.call(n,e)})}[].indexOf||(Array.prototype.indexOf=function(e,n,t){for(n=((t=this.length)+~~n)%t;n<t&&(!(n in this)||this[n]!==e);n++);return n^t?n:-1});var t={us:{backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,pause:19,break:19,capslock:20,escape:27,esc:27,space:32,spacebar:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,meta:91,command:91,windows:91,win:91,_91:92,select:93,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,multiply:106,add:107,subtract:109,decimal:110,divide:111,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,numlock:144,num:144,scrolllock:145,scroll:145,semicolon:186,equal:187,equalsign:187,comma:188,dash:189,period:190,slash:191,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222}},r=t.us,l=[],u={},s=[];function d(){for(var e=[],n=s.length;-1<n;--n)if(s[n])for(var t=s[n],r=0;r<t.length;r+=1){for(var o=t[r],f=!0,a=0;a<o.keys.length;a+=1){var i=o.keys[a];l.indexOf(i)<0&&(f=!1)}f&&e.push(o)}return e}function o(e){var n,t,r=d();for(t in u)if(u.hasOwnProperty(t)){for(var o=u[t],f=!1,a=0;a<r.length;a+=1)if(r[a].keyCombo===t){f=!0;break}f||("function"==typeof o.endCallback&&(o.endCallback(e,o.keys,o.keyCombo)||(n=!1)),delete u[t])}return n}function h(e,n,t){for(var r=e.toLowerCase().replace(/\s/g,"").split(","),o=0;o<r.length;o+=1){var f,a=r[o].split("+");a.length&&(s[a.length]||(s[a.length]=[]),f={callback:n,endCallback:t,keyCombo:r[o],keys:a},s[a.length].push(f))}return{clear:function(){var e;a&&a.length&&-1<s[a.length].indexOf(f)&&(e=s[a.length].indexOf(f),s[a.length].splice(e,1))}}}return e(document,"keydown",function(e){for(var n in r)r.hasOwnProperty(n)&&e.keyCode===r[n]&&l.indexOf(n)<0&&l.push(n);return function(e){if(l<1)return!0;for(var n,t=d(),r=[],o=0;o<t.length;o+=1){for(var f=t[o],a=!1,i=0;i<f.keys.length;i+=1){var c=f.keys[i];if(-1<r.indexOf(c)){a=!0;break}}if(!a){"function"==typeof f.callback&&(f.callback(e,f.keys,f.keyCombo)||(n=!1)),u[f.keyCombo]||(u[f.keyCombo]=f);for(i=0;i<f.keys.length;i+=1){c=f.keys[i];r.indexOf(c)<0&&r.push(c)}}}if(r.length)return!1;return n}(e)}),e(document,"keyup",function(e){for(var n in r){var t;!r.hasOwnProperty(n)||e.keyCode!==r[n]||-1<(t=l.indexOf(n))&&l.splice(t,1)}return o(e)}),e(window,"blur",function(){return l=[],o(event)}),{bind:{key:h,axis:function(e,n,t,r,o){var f=[0,0];if("function"!=typeof o)return!1;var a=h(e,function(){0===f[0]&&(f[0]=-1)},function(){f[0]=0}).clear,i=h(n,function(){0===f[0]&&(f[0]=1)},function(){f[0]=0}).clear,c=h(t,function(){0===f[1]&&(f[1]=-1)},function(){f[1]=0}).clear,l=h(r,function(){0===f[1]&&(f[1]=1)},function(){f[1]=0}).clear,u=setInterval(function(){0===f[0]&&0===f[1]||o(f)},1);return{clear:function(){"function"==typeof a&&a(),"function"==typeof i&&i(),"function"==typeof c&&c(),"function"==typeof l&&l(),"function"==typeof u&&clearInterval(u)}}}},activeKeys:function(){return l},unbind:{key:function(e){if("all"!==e){e=e.replace(/\s/g,"").split(",");for(var n=s.length;-1<n;--n)if(s[n])for(var t=s[n],r=0;r<t.length;r+=1){for(var o=t[r],f=!1,a=0;a<o.keys.length;a+=1){for(var i=o.keys[a],c=0;c<e.length;c+=1)if(e[c]===i){f=!0;break}if(f)break}f&&(s[n].splice(r,1),--r,s[n].length<1&&delete s[n])}}else s=[]}},locale:{add:function(e,n){t[e]=n},set:function(e){t[e]&&(r=t[e])}}}});